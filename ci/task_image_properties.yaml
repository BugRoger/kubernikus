---
platform: 'linux'

image_resource:
  type: docker-image
  source:
    repository: alpine 
    tag: '3.6'

inputs:
  - name: image0
  - name: image1

outputs:
  - name: properties

params:
  image0: IMAGE0
  image1: IMAGE1

run:
  path: /bin/sh
  args:
    - -c
    - |
      set -exo pipefail
      cat >"properties/properties.json" <<EOF
      {
          "${image0}_REPOSITORY": "$(cat image0/repository 2>/dev/null|| true)",
          "${image1}_REPOSITORY": "$(cat image1/repository 2>/dev/null|| true)",
          "${image0}_TAG": "$(cat image0/tag 2>/dev/null|| true)",
          "${image1}_TAG": "$(cat image1/tag 2>/dev/null|| true)",
          "${image0}_DIGEST": "$(cat image0/digest 2>/dev/null|| true)",
          "${image1}_DIGEST": "$(cat image1/digest 2>/dev/null|| true)"
      }
      EOF
